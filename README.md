# MIS 

### Инструкция по запуску проекта
1. Клонируем проект
```bash
git clone https://github.com/artbazeev/mis
```
2. Переходим в mis
```bash
cd mis
```
3. Запускаем контейнеры
```bash
docker-compose up --build -d
```
5. Переходим в контейнер web
```bash
docker-compose exec web bash
```
6. Применяем миграции
```bash
python manage.py migrate
```
7. Заполняем файлы static для админки и отображения swagger
```bash
python manage.py collectstatic
```
8. Создаем пользователя для админки и отображения swagger
```bash
python manage.py createsuperuser
```

10. **https://<ip-хоста>/admin - доступ к админ.панели

11. **https://<ip-хоста>/api/v1/swagger - доступ к апи, если сваггер не отображается выполнить шаг 7


## Основные эндпоинты API
### Пользователи
/api/v1/user/ — список и создание пользователей.

/api/v1/user/{id}/ — просмотр, обновление, удаление пользователя.

/api/v1/user/login/ — авторизация (JWT токен).

/api/v1/user/register/ — регистрация.

/api/v1/user/me/ — данные текущего авторизованного пользователя.

/api/v1/user/change-password/ — смена пароля.

### Доктора
/api/v1/doctor/ — список и создание докторов.

/api/v1/doctor/{id}/ — просмотр, обновление, удаление доктора.

/api/v1/doctor/{id}/clinics/ — список клиник, в которых работает доктор.

### Пациенты
/api/v1/patient/ — список и создание пациентов.

/api/v1/patient/{id}/ — просмотр, обновление, удаление пациента.

### Клиники
/api/v1/clinic/ — список клиник (просмотр доступен всем авторизованным).

/api/v1/clinic/{id}/ — просмотр, обновление, удаление клиники (изменения только суперпользователь).

### Консультации
/api/v1/consultation/ — список, создание, просмотр, обновление, удаление консультаций.

/api/v1/consultation/{id}/ — работа с конкретной консультацией.

/api/v1/consultation/{id}/set_status/ — смена статуса консультации.

Поддерживаются фильтры:

?status=... — фильтр по статусу.

?search=ФИО — поиск по ФИО доктора или пациента.

?ordering=created или ?ordering=-created — сортировка по дате создания.

### Запуск тестов

При запущенных контейнерах необходимо выполнить команду в соседней вкладе
```bash
docker compose run --rm web bash -lc "pytest -v"
```
